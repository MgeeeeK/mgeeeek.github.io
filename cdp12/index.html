<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Coding Period: First Phase Part 2 - MgeeeeK Home</title><meta name="Description" content="Guide to emoji usage in Hugo and LoveIt."><meta property="og:title" content="Coding Period: First Phase Part 2" />
<meta property="og:description" content="Guide to emoji usage in Hugo and LoveIt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mgeeeek.github.io/cdp12/" /><meta property="og:image" content="https://mgeeeek.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-29T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2020-06-29T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://mgeeeek.github.io/logo.png"/>

<meta name="twitter:title" content="Coding Period: First Phase Part 2"/>
<meta name="twitter:description" content="Guide to emoji usage in Hugo and LoveIt."/>
<meta name="application-name" content="$ cd $HOME">
<meta name="apple-mobile-web-app-title" content="$ cd $HOME"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://mgeeeek.github.io/cdp12/" /><link rel="prev" href="https://mgeeeek.github.io/cdp11/" /><link rel="next" href="https://mgeeeek.github.io/cdp21/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Coding Period: First Phase Part 2",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/mgeeeek.github.io\/cdp12\/"
        },"image": ["https:\/\/mgeeeek.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "pysal, CPP1P2","wordcount":  1167 ,
        "url": "https:\/\/mgeeeek.github.io\/cdp12\/","datePublished": "2020-06-29T00:00:00+00:00","dateModified": "2020-06-29T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/mgeeeek.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Mragank Shekhar"
            },"description": "Guide to emoji usage in Hugo and LoveIt."
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="MgeeeeK Home"><span class="header-title-pre"><i class='fas fa-dollar-sign fa-fw'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/files/mragankshekhar_cv260521.pdf"> Resume </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="MgeeeeK Home"><span class="header-title-pre"><i class='fas fa-dollar-sign fa-fw'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/files/mragankshekhar_cv260521.pdf" title="">Resume</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Coding Period: First Phase Part 2</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/MgeeeeK" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Mragank Shekhar</a></span>&nbsp;<span class="post-category">included in <a href="/categories/gsoc20/"><i class="far fa-folder fa-fw"></i>gsoc20</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="29-06-2020">29-06-2020</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1167 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;<span id="/cdp12/" class="leancloud_visitors" data-flag-title="Coding Period: First Phase Part 2">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#progress-on-the-project">Progress on the Project</a></li>
    <li><a href="#new-api-designenhancements">New API Design/Enhancements</a></li>
    <li><a href="#example-notebook-for-raster-interface">Example Notebook for Raster Interface</a></li>
    <li><a href="#experience">Experience</a></li>
    <li><a href="#whats-next">What’s next?</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p><em>Phase 1 of the coding period is about to get over and 2 weeks have already passed since I gave an update on my GSoC project. As per my last <a href="https://mgeeeek.github.io/posts/2020/06/coding-period-first-phase-part-1/" target="_blank" rel="noopener noreffer">blog</a>, I successfully implemented the prototype transformation methods of the base interface, let’s look at the developments happened after the first 2 weeks.</em></p>
<h2 id="progress-on-the-project">Progress on the Project</h2>
<p>The main goal of the first phase was to implement and finalize the base raster interface, in other words, I had to incorporate all methods which can be utilized to make the transformations from <code>xarray.DataArray</code> to both weight objects of PySAL (explained in my previous blog) and convert data back to <code>xarray.DataArray</code>. In the first 2 weeks of the coding period, we discussed the potential API of these methods and I worked on the prototype functions (this pr shows the initial prototype).</p>
<p>The proposed timeline in the project proposal for last 2 weeks is listed below:</p>
<ul>
<li><i class="far fa-check-square fa-fw"></i> Design the Uniform API which will aid in building the interface and in integrating well across PySAL library.</li>
<li><i class="far fa-check-square fa-fw"></i> Finalize the logic of the transformational methods based on eager evaluation.</li>
<li><i class="far fa-square fa-fw"></i> Add additional functionality to convert raster data straight to <code>Geo/Pandas Dataframe</code></li>
<li><i class="far fa-check-square fa-fw"></i> Implement other required raster utility methods.</li>
<li><i class="far fa-check-square fa-fw"></i> Create utility functions that will be required for reshaping and aligning the raster data with spatial weights matrix.</li>
<li><i class="far fa-check-square fa-fw"></i> Create a functionality for processing the outputs from PySAL to write them out to <code>rasterio</code> object. (<em><code>rasterio</code> was replaced by <code>xarray</code>, read last blog for the reason</em>)</li>
</ul>
<p>Most of the tasks were achieved during this period except 3rd one which is not in our plan currently but I will look into it in the later stage.</p>
<h2 id="new-api-designenhancements">New API Design/Enhancements</h2>
<p>After several discussions with my mentors it was decided that the better way to present the transformational methods to the user is by using class methods through the contiguity classes (<code>Rook</code> and <code>Queen</code> for now). This required some modification in the existing weights object, current approach adds one additional attribute to store the coordinates of non-missing values (this will be further discussed with the rest of the community during this weeks group call). After finalizing the base interface by adding necessary changes targeting the community feedback I&rsquo;ll add the tests.</p>
<h2 id="example-notebook-for-raster-interface">Example Notebook for Raster Interface</h2>
<p>This notebook will provide an overview of ways we can use newly added raster interface to operate on raster data.</p>
<p><a href="https://mybinder.org/v2/gh/MgeeeeK/GSoC2020/master?filepath=gsoc_phase_1_raster_interface.ipynb" target="_blank" rel="noopener noreffer"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://mybinder.org/badge_logo.svg"
        data-srcset="https://mybinder.org/badge_logo.svg, https://mybinder.org/badge_logo.svg 1.5x, https://mybinder.org/badge_logo.svg 2x"
        data-sizes="auto"
        alt="https://mybinder.org/badge_logo.svg"
        title="Binder" /></a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">from</span> <span class="nn">libpysal.weights</span> <span class="kn">import</span> <span class="n">Rook</span><span class="p">,</span> <span class="n">Queen</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="kn">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">esda</span> <span class="kn">import</span> <span class="n">Moran_Local</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>/data/GSoC/libpysal/libpysal/weights/util.py:20: UserWarning: geopandas not available. Some functionality will be disabled.
  warn('geopandas not available. Some functionality will be disabled.')
</code></pre>
<p>Currently each method inside this interface only accepts <code>xarray.DataArray</code> as input, let&rsquo;s read in some data using <code>open_rasterio()</code> method:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Multiband band raster data with no missing values</span>
<span class="n">da1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s1">&#39;HARV_RGB_Ortho.tif&#39;</span><span class="p">)</span>
<span class="c1"># Slicing the dataarray</span>
<span class="n">da1</span> <span class="o">=</span> <span class="n">da1</span><span class="p">[:,</span> <span class="mi">600</span><span class="p">:</span><span class="mi">700</span><span class="p">,</span> <span class="mi">700</span><span class="p">:</span><span class="mi">800</span><span class="p">]</span> 
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Ploting only first band of the da</span>
<span class="n">da1</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><a class="lightgallery" href="/images/Untitled_4_1.png" title="png" data-thumbnail="/images/Untitled_4_1.png">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/images/Untitled_4_1.png"
            data-srcset="/images/Untitled_4_1.png, /images/Untitled_4_1.png 1.5x, /images/Untitled_4_1.png 2x"
            data-sizes="auto"
            alt="png" />
    </a>
<p>After accessing the raster data we will create weights object using a method called <code>from_xarray</code> from Rook class</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Let&#39;s check the method first</span>
<span class="n">help</span><span class="p">(</span><span class="n">Rook</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>Help on method from_xarray in module libpysal.weights.contiguity:

from_xarray(da, band=None, sparse=False, **kwargs) method of builtins.type instance
    Construct a weights object from a xarray.DataArray object 
    
    Parameters
    ----------
    da         : xarray.DataArray
                raster file accessed using xarray.open_rasterio method
    band       : int
                select band for raster with multiple bands
    sparse     : boolean
                type of weight object. Default is dense. For sparse, sparse = True
    **kwargs   : keyword arguments
                optional arguments for :class:`pysal.weights.W`
    See Also
    --------
    :class:`libpysal.weights.weights.W`
</code></pre>
<p><code>from_xarray</code> method will first check if data can be converted and if the bands is passed or not, if not passed then it&rsquo;ll select first band as default</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Creating weight of object from raster</span>
<span class="n">w_rook</span> <span class="o">=</span> <span class="n">Rook</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">da1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>/data/GSoC/libpysal/libpysal/weights/raster.py:37: UserWarning: Multiple bands detected in the DataArray. Using default band 1 for further computation
  warn('Multiple bands detected in the DataArray. Using default band 1 for further computation')
</code></pre>
<p>This created weight object contains one additional attribute <code>coords</code> which stores the coordinates of non missing values in the form of <code>MultiIndex</code> of <code>pandas.Series</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Quick view at the data stored in coords</span>
<span class="n">w_rook</span><span class="o">.</span><span class="n">coords</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>MultiIndex([(1, 4713385.375, 732173.625),
            (1, 4713385.375, 732173.875),
            (1, 4713385.375, 732174.125),
            (1, 4713385.375, 732174.375),
            (1, 4713385.375, 732174.625)],
           names=['band', 'y', 'x'])
</code></pre>
<p>After converting <code>DataArray</code> to <code>pandas,Series</code>, we can access non missing values of raster data (<em>this is still under process of review</em>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Loading the raster data for further calculation</span>
<span class="n">data1</span> <span class="o">=</span> <span class="n">da1</span><span class="o">.</span><span class="n">to_series</span><span class="p">()[</span><span class="n">w_rook</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
<span class="n">data1</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>band  y            x         
1     4713385.375  732173.625    132.0
                   732173.875     94.0
                   732174.125     91.0
                   732174.375    110.0
                   732174.625    106.0
dtype: float64
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Quickly computing and loading a LISA</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">lisa</span> <span class="o">=</span> <span class="n">Moran_Local</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span><span class="n">w_rook</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>We&rsquo;ll now try to convert computed data back to <code>xarray.DataArray</code>, we can use <code>to_xarray</code> method belonging to weight method for the transformation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Let&#39;s check the method first</span>
<span class="n">help</span><span class="p">(</span><span class="n">w_rook</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>Help on method to_xarray in module libpysal.weights.weights:

to_xarray(data, indices=None, attrs=None) method of libpysal.weights.weights.W instance
    converts the aligned data to a `xarray.DataArray` object
    
    Arguments
    ---------
    data    :   array
                data values stored in 1d array
    indices :   Dictionary/xarray.core.coordinates.DataArrayCoordinates
                coordinates from original DataArray
    attrs   :   Dictionary
                attributes from original DataArray 
    Returns
    -------
    
    da : xarray.DataArray
        instance of xarray.DataArray
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Converting obtained data back to DataArray</span>
<span class="n">moran_da1</span> <span class="o">=</span> <span class="n">w_rook</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">lisa</span><span class="o">.</span><span class="n">p_sim</span><span class="p">,</span> <span class="n">da1</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">da1</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Plotting the converted DataArray</span>
<span class="n">moran_da1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><a class="lightgallery" href="/images/Untitled_17_1.png" title="png" data-thumbnail="/images/Untitled_17_1.png">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/images/Untitled_17_1.png"
            data-srcset="/images/Untitled_17_1.png, /images/Untitled_17_1.png 1.5x, /images/Untitled_17_1.png 2x"
            data-sizes="auto"
            alt="png" />
    </a>
<p>We&rsquo;ll now perform same operations on different raster data</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># single band raster data with missing values</span>
<span class="n">da2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="s1">&#39;nasadem_sd.tif&#39;</span><span class="p">)</span>
<span class="c1"># slicing the dataarray</span>
<span class="n">da2</span> <span class="o">=</span> <span class="n">da2</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span><span class="mi">400</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># ploting dataarray after removing missing values</span>
<span class="n">da2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da2</span><span class="o">.</span><span class="n">data</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><a class="lightgallery" href="/images/Untitled_20_1.png" title="png" data-thumbnail="/images/Untitled_20_1.png">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/images/Untitled_20_1.png"
            data-srcset="/images/Untitled_20_1.png, /images/Untitled_20_1.png 1.5x, /images/Untitled_20_1.png 2x"
            data-sizes="auto"
            alt="png" />
    </a>
<p>This time we will create weights object using <code>Queen</code> class</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Creating weight of object from raster</span>
<span class="n">w_queen</span> <span class="o">=</span> <span class="n">Queen</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">da2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Loading the raster data for further calculation</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">da2</span><span class="o">.</span><span class="n">to_series</span><span class="p">()[</span><span class="n">w_queen</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
<span class="n">data2</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>band  y       x          
1     33.505  -117.509444    256
              -117.509167    261
              -117.508889    263
              -117.508611    263
              -117.508333    264
dtype: int16
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Quickly computing and loading a LISA</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">lisa</span> <span class="o">=</span> <span class="n">Moran_Local</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span><span class="n">w_queen</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Let&#39;s check the method first</span>
<span class="n">moran_da2</span> <span class="o">=</span> <span class="n">w_queen</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">lisa</span><span class="o">.</span><span class="n">p_sim</span><span class="p">,</span> <span class="n">da2</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">da2</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Plotting the converted DataArray</span>
<span class="n">moran_da2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">moran_da2</span><span class="o">.</span><span class="n">data</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><a class="lightgallery" href="/images/Untitled_26_1.png" title="png" data-thumbnail="/images/Untitled_26_1.png">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/images/Untitled_26_1.png"
            data-srcset="/images/Untitled_26_1.png, /images/Untitled_26_1.png 1.5x, /images/Untitled_26_1.png 2x"
            data-sizes="auto"
            alt="png" />
    </a>
<h2 id="experience">Experience</h2>
<p>Without a doubt, this summer has been very interesting and worthwhile with tons of knowledge gained and new things explored related to the project. After every interaction with my mentors, my appreciation for PySAL grow even more, I&rsquo;m able to understand the design decisions went behind the creation of APIs, different methods and overall structure of each module in PySAL library.</p>
<h2 id="whats-next">What’s next?</h2>
<p>There are some API fixes which my mentors suggested I&rsquo;ll work on those side by side I&rsquo;ll also work on the feedback and suggestions which will be given by the community in the upcoming group call and will try to finalize the interface before next week, after that I&rsquo;ll add remaining tests and docstring examples.</p>
<p>Wait for my next blog which will shed some light on the optimization part along with the integration of the interface with other parts of the library&hellip; Till then adios amigos 👋.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 29-06-2020</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/cdp12/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/pysal/">pysal</a>,&nbsp;<a href="/tags/cpp1p2/">CPP1P2</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/cdp11/" class="prev" rel="prev" title="Coding Period: First Phase Part 1"><i class="fas fa-angle-left fa-fw"></i>Coding Period: First Phase Part 1</a>
            <a href="/cdp21/" class="next" rel="next" title="Coding Period: Second Phase Part 1">Coding Period: Second Phase Part 1<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
    <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer"
                title="Hugo 0.83.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank"
                rel="noopener noreffer" title="LoveIt 0.2.10"><i class="fab fa-github"></i></a>
        </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a
                    href="https://github.com/MgeeeeK" target="_blank">Mragank Shekhar</a></span></div>
    </div>
</footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"valine":{"appId":"QGzwQXOqs5JOhN4RGPOkR2mR-MdYXbMMI","appKey":"WBmoGyJtbqUswvfLh6L8iEBr","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"serverURLs":"https://leancloud.hugoloveit.com","visitor":true}},"data":{"id-1":"cd $HOME","id-2":"cd $HOME"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
